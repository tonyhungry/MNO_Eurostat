<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.3 Device-to-cell association | Mobile Network Operator Data for Spatial Statistics - Eurostat Coding Labs 2020</title>
  <meta name="description" content="A showcase of our remote collaborative efforts from working on the MNO project" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4.3 Device-to-cell association | Mobile Network Operator Data for Spatial Statistics - Eurostat Coding Labs 2020" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A showcase of our remote collaborative efforts from working on the MNO project" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.3 Device-to-cell association | Mobile Network Operator Data for Spatial Statistics - Eurostat Coding Labs 2020" />
  
  <meta name="twitter:description" content="A showcase of our remote collaborative efforts from working on the MNO project" />
  

<meta name="author" content="Giulia Regazzoni, Marco Ramljak, Stefania Scrofani, Tony Hung" />


<meta name="date" content="2020-12-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="generation-of-a-synthetic-radio-network-1.html"/>
<link rel="next" href="estimation-strategies-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Cover</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="executive-summary.html"><a href="executive-summary.html"><i class="fa fa-check"></i><b>3</b> Executive Summary</a><ul>
<li class="chapter" data-level="3.0.1" data-path="executive-summary.html"><a href="executive-summary.html#preface"><i class="fa fa-check"></i><b>3.0.1</b> Preface</a></li>
<li class="chapter" data-level="3.0.2" data-path="executive-summary.html"><a href="executive-summary.html#toy-world-generation"><i class="fa fa-check"></i><b>3.0.2</b> Toy World Generation</a></li>
<li class="chapter" data-level="3.0.3" data-path="executive-summary.html"><a href="executive-summary.html#estimation-strategies"><i class="fa fa-check"></i><b>3.0.3</b> Estimation strategies</a></li>
<li class="chapter" data-level="3.0.4" data-path="executive-summary.html"><a href="executive-summary.html#evaluation-of-all-estimates"><i class="fa fa-check"></i><b>3.0.4</b> Evaluation of all estimates</a></li>
<li class="chapter" data-level="3.0.5" data-path="executive-summary.html"><a href="executive-summary.html#excurse-evaluation-looking-deeper-into-the-convergence-behavior"><i class="fa fa-check"></i><b>3.0.5</b> Excurse Evaluation: Looking deeper into the convergence behavior</a></li>
<li class="chapter" data-level="3.0.6" data-path="executive-summary.html"><a href="executive-summary.html#final-remarks"><i class="fa fa-check"></i><b>3.0.6</b> Final Remarks</a></li>
<li class="chapter" data-level="3.0.7" data-path="executive-summary.html"><a href="executive-summary.html#references"><i class="fa fa-check"></i><b>3.0.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="making-a-toy-world.html"><a href="making-a-toy-world.html"><i class="fa fa-check"></i><b>4</b> Making a Toy World</a><ul>
<li class="chapter" data-level="4.1" data-path="generation-of-population.html"><a href="generation-of-population.html"><i class="fa fa-check"></i><b>4.1</b> Generation of Population</a></li>
<li class="chapter" data-level="4.2" data-path="generation-of-a-synthetic-radio-network-1.html"><a href="generation-of-a-synthetic-radio-network-1.html"><i class="fa fa-check"></i><b>4.2</b> Generation of a synthetic Radio Network</a></li>
<li class="chapter" data-level="4.3" data-path="device-to-cell-association-1.html"><a href="device-to-cell-association-1.html"><i class="fa fa-check"></i><b>4.3</b> Device-to-cell association</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimation-strategies-1.html"><a href="estimation-strategies-1.html"><i class="fa fa-check"></i><b>5</b> Estimation Strategies</a></li>
<li class="chapter" data-level="6" data-path="evaluation-methods.html"><a href="evaluation-methods.html"><i class="fa fa-check"></i><b>6</b> Evaluation Methods</a></li>
<li class="chapter" data-level="7" data-path="a-final-note.html"><a href="a-final-note.html"><i class="fa fa-check"></i><b>7</b> A Final Note</a></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mobile Network Operator Data for Spatial Statistics - Eurostat Coding Labs 2020</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="device-to-cell-association-1" class="section level2">
<h2><span class="header-section-number">4.3</span> Device-to-cell association</h2>
<p>At this stage we have added to the geographically distributed mobile phone population a radio network, which is setup in three layers, spanning respectively across tiles that correspond to specific tile classification. (<code>pop.area.kind</code>).</p>
<p>The following module will establish the association between mobile phones of a generic tile to a relevant antenna. The result will be a reference matrix <span class="math inline">\(P\)</span> of size <span class="math inline">\(I x J\)</span>, where I denotes the total number of radio cells (antennas), <span class="math inline">\(J\)</span> is the total number of tiles and the elements correspond to the probability of the mobile phones of any tile <span class="math inline">\(j\)</span> are registered in the cell <span class="math inline">\(i\)</span>. With <span class="math inline">\(P\)</span> one is able to simulate the column vector <span class="math inline">\(c\)</span> (random variable) which describes the total count of mobile phone associated to a radio cell.</p>
<p>Assuming that <span class="math inline">\(\mathcal{L}_{j}\)</span> denotes the subset of radio cells covering a particular tile (remember, overlapping coverage areas are very common). This means that these respective radio cells are competing with each other to be associated with the cell phones in the tile. We therefore assign probabilities which describe the respective association between a radio cell <span class="math inline">\(i\)</span> and tile <span class="math inline">\(j\)</span>. This probability depends on the parameter signal strength which we mimic with a simple linear function that describes the gradual decrease in signal the further away the tile centroid <span class="math inline">\(j\)</span> is from the coverage area centroid of <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[
s_{ij} = \frac{d_{ij}}{r_{i}}
\]</span></p>
<p>We basically calculate the distance between the two centroids, <span class="math inline">\(d_{ij}\)</span>, and divide it between the radius of that radio cell, <span class="math inline">\(r_{i}\)</span>- it is denoted by <span class="math inline">\(s_{ij}\)</span>. We introduce a minimum threshold value <span class="math inline">\(\nu\)</span> which limits radio cells with a too low signal intensity <span class="math inline">\(s_{ij}\)</span> for a particular tile to be able to be picked up by a mobile phone in that tile - resulting in the minimum value of 0. We also introduce a maximum threshold, describing tiles that are very close to the coverage area centroid, i.e. a high value for <span class="math inline">\(s_{ij}\)</span> – when passing this threshold their respective <span class="math inline">\(s_{ij}\)</span> values result in the maximum value 1. This particular operationalization of a function modeling the signal strength parameter instead of fixed categorical signal strength values makes the overall workflow of the notebook more realistic (granularity) and more modular as one can later implement very easy even more realistic functions describing the signal strength parameter. In this scenario we have implemented a minimum threshold of <span class="math inline">\(\nu = 0.01\)</span> and a maximum threshold of <span class="math inline">\(\zeta = 0.01\)</span> depending on <span class="math inline">\(r_{i}\)</span>. The exact operationalization can be found <a href="https://github.com/R-ramljak/MNO_GM/blob/master/3_device%20to%20cell.R">here</a>.</p>
<p>The elements of <span class="math inline">\(P\)</span> - the probability with which the mobile phones within a particular cell are associated with a particular radio cell - are defined by</p>
<p><span class="math display">\[
p_{ij} = \frac{s_{ij}}{\sum_{i \in \mathcal{L}_{j}} s_{ij}}
\]</span></p>
<p>where <span class="math inline">\(s_{ij}\)</span> describes the signal intensity of a particular cell <span class="math inline">\(i\)</span> associated with a particular tile <span class="math inline">\(j\)</span>, and <span class="math inline">\(\mathcal{L}_{j}\)</span> describes the subset of radio cells that are covering the tile <span class="math inline">\(j\)</span>. We then simulate the tile specific experiments - every mobile phone within a tile will be independently assigned to relevant radio cell with the probability <span class="math inline">\(p_{ij}\)</span>. The result is the column vector <span class="math inline">\(c\)</span> which will act as a reference for the later on introduced estimation strategies.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="device-to-cell-association-1.html#cb20-1"></a>C.vec.df &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;working objects/C.vec.df.final.new.rds&quot;</span>)</span>
<span id="cb20-2"><a href="device-to-cell-association-1.html#cb20-2"></a><span class="co"># ECCDF of population distribution </span></span>
<span id="cb20-3"><a href="device-to-cell-association-1.html#cb20-3"></a>ECCDF.phones.data &lt;-<span class="st"> </span>C.vec.df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-4"><a href="device-to-cell-association-1.html#cb20-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">layer =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(antenna.ID, <span class="st">&quot;RT&quot;</span>) <span class="op">~</span><span class="st"> &quot;Layer 1&quot;</span>,</span>
<span id="cb20-5"><a href="device-to-cell-association-1.html#cb20-5"></a>                           <span class="kw">str_detect</span>(antenna.ID, <span class="st">&quot;ST&quot;</span>) <span class="op">~</span><span class="st"> &quot;Layer 2&quot;</span>,</span>
<span id="cb20-6"><a href="device-to-cell-association-1.html#cb20-6"></a>                           <span class="kw">str_detect</span>(antenna.ID, <span class="st">&quot;UT&quot;</span>) <span class="op">~</span><span class="st"> &quot;Layer 3&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-7"><a href="device-to-cell-association-1.html#cb20-7"></a><span class="st">  </span><span class="kw">arrange</span>(phones.sum) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb20-8"><a href="device-to-cell-association-1.html#cb20-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prob =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb20-9"><a href="device-to-cell-association-1.html#cb20-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cum.prob =</span> <span class="kw">cumsum</span>(prob)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-10"><a href="device-to-cell-association-1.html#cb20-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cum.prob.comp =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>cum.prob) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-11"><a href="device-to-cell-association-1.html#cb20-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log10.cum.prob.comp =</span> <span class="kw">log10</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>cum.prob)) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb20-12"><a href="device-to-cell-association-1.html#cb20-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log10.phones =</span> <span class="kw">log10</span>(phones.sum))</span>
<span id="cb20-13"><a href="device-to-cell-association-1.html#cb20-13"></a></span>
<span id="cb20-14"><a href="device-to-cell-association-1.html#cb20-14"></a>ECCDF.phones.plot &lt;-<span class="st"> </span>ECCDF.phones.data <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb20-15"><a href="device-to-cell-association-1.html#cb20-15"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-16"><a href="device-to-cell-association-1.html#cb20-16"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log10.phones, <span class="dt">y =</span> log10.cum.prob.comp, </span>
<span id="cb20-17"><a href="device-to-cell-association-1.html#cb20-17"></a>                 <span class="dt">color =</span> layer)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-18"><a href="device-to-cell-association-1.html#cb20-18"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">-0.3010300</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-19"><a href="device-to-cell-association-1.html#cb20-19"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">-1</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-20"><a href="device-to-cell-association-1.html#cb20-20"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="fl">-0.15</span>, <span class="dt">label =</span> <span class="st">&quot;50% of the data&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-21"><a href="device-to-cell-association-1.html#cb20-21"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="fl">-0.85</span>, <span class="dt">label =</span> <span class="st">&quot;90% of the data&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-22"><a href="device-to-cell-association-1.html#cb20-22"></a><span class="st">  </span><span class="kw">scale_color_ptol</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Layer 1&quot;</span>, <span class="st">&quot;Layer 2&quot;</span>, <span class="st">&quot;Layer 3&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-23"><a href="device-to-cell-association-1.html#cb20-23"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb20-24"><a href="device-to-cell-association-1.html#cb20-24"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb20-25"><a href="device-to-cell-association-1.html#cb20-25"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;log10(Prob(Y &gt; x))&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;log10(Mobile phones)&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb20-26"><a href="device-to-cell-association-1.html#cb20-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-27"><a href="device-to-cell-association-1.html#cb20-27"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">9</span>,<span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb20-28"><a href="device-to-cell-association-1.html#cb20-28"></a>ECDF.phones.plot &lt;-<span class="st"> </span>ECCDF.phones.data <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb20-29"><a href="device-to-cell-association-1.html#cb20-29"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-30"><a href="device-to-cell-association-1.html#cb20-30"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> phones.sum, <span class="dt">y =</span> cum.prob.comp, <span class="dt">color =</span> layer)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-31"><a href="device-to-cell-association-1.html#cb20-31"></a><span class="st">  </span><span class="kw">scale_color_ptol</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Uninhabitated&quot;</span>, <span class="st">&quot;Rural&quot;</span>, <span class="st">&quot;Suburban&quot;</span>, <span class="st">&quot;Urban&quot;</span>), <span class="dt">guide =</span> <span class="ot">FALSE</span>, <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb20-32"><a href="device-to-cell-association-1.html#cb20-32"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb20-33"><a href="device-to-cell-association-1.html#cb20-33"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">8000</span>) <span class="op">+</span></span>
<span id="cb20-34"><a href="device-to-cell-association-1.html#cb20-34"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-35"><a href="device-to-cell-association-1.html#cb20-35"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-36"><a href="device-to-cell-association-1.html#cb20-36"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb20-37"><a href="device-to-cell-association-1.html#cb20-37"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>())</span>
<span id="cb20-38"><a href="device-to-cell-association-1.html#cb20-38"></a>pop.dist.ecdf.insert &lt;-<span class="st"> </span>ECCDF.phones.plot <span class="op">+</span></span>
<span id="cb20-39"><a href="device-to-cell-association-1.html#cb20-39"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">ggplotGrob</span>(ECDF.phones.plot), </span>
<span id="cb20-40"><a href="device-to-cell-association-1.html#cb20-40"></a>                    <span class="dt">xmin =</span> <span class="dv">0</span>, <span class="dt">xmax =</span> <span class="dv">2</span>, </span>
<span id="cb20-41"><a href="device-to-cell-association-1.html#cb20-41"></a>                    <span class="dt">ymin =</span> <span class="dv">-4</span>, <span class="dt">ymax =</span> <span class="fl">-1.5</span>)</span>
<span id="cb20-42"><a href="device-to-cell-association-1.html#cb20-42"></a>    </span>
<span id="cb20-43"><a href="device-to-cell-association-1.html#cb20-43"></a><span class="kw">plot_grid</span>(pop.dist.ecdf.insert, <span class="dt">labels =</span> <span class="st">&quot;Fig. 8: ECCDF Device-to-cell association&quot;</span>,  <span class="dt">hjust =</span> <span class="fl">-0.1</span>, <span class="dt">label_size =</span> <span class="dv">14</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<div class="figure">
<img src="bookdown_files/figure-html/c.vector.distribution-1.png" alt="Mobile devices are predominately associated with Layer 1 antennas." width="864" />
<p class="caption">
(#fig:c.vector.distribution)Mobile devices are predominately associated with Layer 1 antennas.
</p>
</div>
<p>Once again, we use the ECCDF with log10 to understand the distribution of the device-to-cell association. 50% of the devices is associated to the cells in the Rural layer. Furthermore, 90% of the devices are associated only to cells of layer 1 and layer 2, respectively Rural and Suburban. ONly 10% of the devices are assocaited also to the layer 3, which Urban.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="device-to-cell-association-1.html#cb22-1"></a>extreme.antennas.plot &lt;-<span class="st"> </span>C.vec.df <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb22-2"><a href="device-to-cell-association-1.html#cb22-2"></a><span class="st">  </span><span class="kw">filter</span>(phones.sum <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10000</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-3"><a href="device-to-cell-association-1.html#cb22-3"></a><span class="st">  </span><span class="kw">left_join</span>(coverage.areas, <span class="dt">by =</span> <span class="st">&quot;antenna.ID&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-4"><a href="device-to-cell-association-1.html#cb22-4"></a><span class="st">  </span><span class="kw">st_as_sf</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-5"><a href="device-to-cell-association-1.html#cb22-5"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-6"><a href="device-to-cell-association-1.html#cb22-6"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">col =</span> area.kind), <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-7"><a href="device-to-cell-association-1.html#cb22-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-8"><a href="device-to-cell-association-1.html#cb22-8"></a><span class="st">  </span><span class="kw">scale_color_ptol</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Rural&quot;</span>, <span class="st">&quot;Suburban&quot;</span>, <span class="st">&quot;Urban&quot;</span>), <span class="st">&quot;Layer&quot;</span>) <span class="op">+</span></span>
<span id="cb22-9"><a href="device-to-cell-association-1.html#cb22-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb22-10"><a href="device-to-cell-association-1.html#cb22-10"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>),<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb22-11"><a href="device-to-cell-association-1.html#cb22-11"></a>  <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb22-12"><a href="device-to-cell-association-1.html#cb22-12"></a></span>
<span id="cb22-13"><a href="device-to-cell-association-1.html#cb22-13"></a><span class="kw">plot_grid</span>(extreme.antennas.plot, <span class="dt">labels =</span> <span class="st">&quot;Fig. 9: Extreme antennas&quot;</span>,</span>
<span id="cb22-14"><a href="device-to-cell-association-1.html#cb22-14"></a>          <span class="dt">hjust =</span> <span class="fl">-0.1</span>, <span class="dt">label_size =</span> <span class="dv">14</span>) </span></code></pre></div>
<div class="figure">
<img src="bookdown_files/figure-html/c.vector%20special%20cases-1.png" alt="These antennas have more than 10,000 mobile devices associated to themselves. They all belong to layer 1 and are located close or within urban centers." width="672" />
<p class="caption">
(#fig:c.vector special cases)These antennas have more than 10,000 mobile devices associated to themselves. They all belong to layer 1 and are located close or within urban centers.
</p>
</div>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="generation-of-a-synthetic-radio-network-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="estimation-strategies-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
