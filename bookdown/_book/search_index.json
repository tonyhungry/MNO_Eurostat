[["evaluation-methods.html", "6 Evaluation Methods", " 6 Evaluation Methods In this section, we will graphically compare the two overall estimation approaches: MLE and Voronoi, and see how well they perform against each other. We will measure the performance through the the lens of empirical distributions (ECCDF plots), spatial distributions (maps), statistical distributions (bar graphs), and finally with the Kantorovich-Wasserstein Distance. The main packages used in this section are: tidyverse, ggthemes, knitr, and cowplot. "],["evaluation-of-all-estimates-1.html", "6.1 Evaluation of all estimates", " 6.1 Evaluation of all estimates We created 4 final estimates: Voronoi tessellation with tower locations as seeds Voronoi tessellation with coverage area locations (antennas) as seeds MLE uniform prior equal probability P.matrix after 1000 iterations MLE uniform prior oracle probability P.matrix after 1000 iterations In the following we compare the distributions of the final estimates to the true distribution of the mobile phone density per tile. Significant variation can only be viewed in the tails of the distribution (ECCDF). # Creating the data frame we need to graph the eccdf true.ECCDF.first &lt;- census.de.100m.tile %&gt;% st_drop_geometry() %&gt;% ungroup() %&gt;% custom_ecdf_prep() %&gt;% dplyr::select(log10.cum.prob.comp, log10.pop, pop.area.kind) %&gt;% mutate(log10.cum.prob.comp = round(log10.cum.prob.comp, 4)) %&gt;% # effective plot sample --&gt; faster plotting excluding overplot distinct() true.ECDF.first &lt;- census.de.100m.tile %&gt;% st_drop_geometry() %&gt;% ungroup() %&gt;% custom_ecdf_prep() %&gt;% dplyr::select(cum.prob.comp, pop.plot, pop.area.kind) %&gt;% mutate(cum.prob.comp = round(cum.prob.comp, 4)) %&gt;% # effective plot sample --&gt; faster plotting excluding overplot distinct() # Plot the ECCDF breaks.first &lt;- c(&quot;Uninhabitated&quot;, &quot;Rural&quot;, &quot;Suburban&quot;, &quot;Urban&quot;) ECCDF.true &lt;- true.ECCDF.first %&gt;% ggplot() + geom_point(aes(x = log10.pop, y = log10.cum.prob.comp, color = pop.area.kind)) + scale_color_ptol(breaks = breaks.first) + ggtitle(&quot;&quot;, subtitle = &quot;ECCDF true mobile phone density&quot;) + labs(y = &quot;Prob(Y &gt; x)&quot;, x = &quot;Mobile phones&quot;, color = &quot;&quot;) saveRDS(ECCDF.true, &quot;Vysoká škola ekonomická v Praze/Tony Wei Tse Hung - YAY/Estimates/Plot.files/ECCDF.true.rds&quot;) # save the plot as a rds file # plot the ecdf using ggplot ECDF.true &lt;- true.ECDF.first %&gt;% ggplot() + geom_point(aes(x = pop.plot, y = cum.prob.comp, color = pop.area.kind)) + scale_color_ptol(breaks = breaks.first, guide = FALSE, expand = c(0, 0)) + labs(y = &quot;&quot;, x = &quot;&quot;) + theme(plot.title = element_text(size = 10, face = &quot;bold&quot;, hjust = 0.5), plot.subtitle = element_text(size = 9, hjust = 0.5), axis.title.x = element_blank(), axis.title.y = element_blank()) saveRDS(ECDF.true, &quot;Vysoká škola ekonomická v Praze/Tony Wei Tse Hung - YAY/Estimates/Plot.files/ECDF.true.rds&quot;) # save the plot as a rds file (#fig:estimator pop dist compare)In this plot one can see the difference in ECCDF and ECDF of the final estimates of the differing strategies compared to the true mobile phone density. In this section we want to further evaluate the 4 estimates by comparing them with different perspectives in mind to the actual true population. Each subsection defines the perspective-respective performance measure: Geographical evaluation through the use of maps to show the final results of each estimation strategy Statistical evaluation through the use of MAD and AAD metrics to compare the statistical accuracy of each estimation strategy. 6.1.1 Geographical Evaluation For the geographical evaluation we use the following performance measure: The visual resemblance of fixed tile categories from the respective estimate and the actual true population on a map. We basically build a map for every final estimate and compare it to the actual true population. We still need to interpret all of them. (#fig:Voronoi tower geo eval)Comparing Voronoi tower estimate (#fig:Voronoi antenna geo eval)Comparing Voronoi antenna estimate (#fig:MLE equal geo eval)MLE Evolution of Iterations 6.1.2 Statistical/Distributional Evaluation In order to actually compare the numerical resemblance between the estimates and the actual true population we introduce two discrepancy performance measures. Average Absolute Discrepancy (AAD): \\(D_{avg}(u,v) = \\frac{1}{U}\\sum_{j = 1}^{J} |u_{j} - v_{j}|\\) Maximum Absolute Discrepancy (MAD): \\(D_{max}(\\textbf{u,v}) \\overset{\\underset{\\mathrm{def}}{}}{=} \\sum_{\\mathit{j = 1}}^{\\mathit{J}}\\left | u_{j} - v_{j} \\right |\\) require(tidyverse) require(ggthemes) # Loading in the data voro &lt;- readRDS(&quot;~/OneDrive - Vysoká škola ekonomická v Praze/YAY/Estimates/Voronoi both/Voronoi.estimates.rds&quot;) # the voronoi estimates equal &lt;- readRDS(&quot;~/OneDrive - Vysoká škola ekonomická v Praze/YAY/Estimates/P.equal/u.est.non.inf.P.equal.part801_1000_new.rds&quot;)[,202] # estimates from the equal population matrix of MLE true &lt;- readRDS(&quot;~/OneDrive - Vysoká škola ekonomická v Praze/YAY/Estimates/P.oracle/u.est.non.inf.P.oracle.part801_1000_new.rds&quot;)[,202] # estimates from the from the true population matrix MLE # Transforming the data voro = cbind(voro, equal, true) *# combining the three data sets together* colnames(voro) = c(&quot;internal.id&quot;,&quot;pop&quot;,&quot;u.antenna&quot;,&quot;u.tower&quot;,&quot;u.equal&quot;,&quot;u.true&quot;) # changing the column names voro = voro [,-1] %&gt;% ungroup() *# taking out unnnecessary column* bigu = sum(voro$pop) *# calculate the constant that we need for MAD* # Average Absolute Discrepancy Calculation: # First we calculate abs(uj-vj), and also delete all original columns involved. # We sum up each column calculated above and divide by the bigu, and delete all original columns involved. aad.table = voro %&gt;% transmute_at(vars(contains(&quot;u.&quot;)),funs(&quot;diff&quot; = abs(pop - .))) %&gt;% summarise_all(funs(&quot;i&quot; = sum(.)/bigu)) colnames(aad.table) = c(&quot;Voronoi ~ Antenna&quot;,&quot;Voronoi ~ Tower&quot;,&quot;MLE ~ Equal&quot;,&quot;MLE ~ True&quot;) # Add column names aadl = aad.table %&gt;% pivot_longer(-c(), names_to = &quot;type&quot;, values_to = &quot;aad&quot;) # Transform the dataset into long format (#tab:aad.table)AAD Table Voronoi ~ Antenna Voronoi ~ Tower MLE ~ Equal MLE ~ True 1.366715 1.410964 1.839367 1.641365 # Graph through ggplot aad.comp.plot = aadl %&gt;% ggplot(aes(x = type,y = aad, fill = type)) + geom_bar(stat=&quot;identity&quot;) + labs(x = &quot;Estimation Type&quot;, y = &quot;Average Absolute Discrepancy&quot;,title = &quot;Comparison Across Different Estimation Strategies ~ AAD&quot;) + theme(axis.text.x = element_text(angle = 90),legend.position = &quot;bottom&quot;) + scale_fill_ptol() saveRDS(aad.comp.plot, file = &quot;aad.comp.plot.rds&quot;) # save the plot # Maximum Absolute Discrepancy Calculation # First we calculate abs(uj-vj), and also delete all original columns involved. # We sum up each column calculated above, and delete all original columns involved. mad.table = voro %&gt;% transmute_at(vars(contains(&quot;u&quot;)),funs(&quot;diff&quot; = abs(pop - .))) %&gt;% summarise_all(funs(&quot;i&quot; = sum(.))) colnames(mad.table) = c(&quot;Voronoi ~ Antenna&quot;,&quot;Voronoi ~ Tower&quot;,&quot;MLE ~ Equal&quot;,&quot;MLE ~ True&quot;) # add column names madl = mad.table %&gt;% pivot_longer(-c(), names_to = &quot;type&quot;, values_to = &quot;mad&quot;) # Transform the dataset into long format. (#tab:mad.table)MAD Table Voronoi ~ Antenna Voronoi ~ Tower MLE ~ Equal MLE ~ True 1.366715 1.410964 1.839367 1.641365 # Graph through ggplot mad.comp.plot = madl %&gt;% ggplot(aes(x = type,y = mad, fill = type)) + geom_bar(stat=&quot;identity&quot;) + labs(x = &quot;Estimation Type&quot;, y = &quot;Maximum Absolute Discrepancy&quot;,title = &quot;Comparison Across Different Estimation Strategies ~ MAD&quot;) + theme(axis.text.x = element_text(angle = 90),legend.position = &quot;bottom&quot;) + scale_fill_ptol() saveRDS(mad.comp.plot, file = &quot;mad.comp.plot.rds&quot;) # save the plot (#fig:voronoi vs MLE)Voronoi Estimation vs MLE By calculating the two discrepancy measures, we can then evaluate the overall performance for each type of estimation. In general, the Voronoi estimates result in less discrepancy compared to both of the MLE estimates. Between the two MLE estimates, the true population matrix has a lower discrepancy than the equal population matrix. Between the two Voronoi estimates, the Voronoi estimation by antennas has a lower discrepancy than the Voronoi estimation by towers. 6.1.3 Kantorovich-Wasserstein Distance (KWD) The KWD is different such that it takes in consideration of the spatial component which was not considered by the previous metrics. Thus it is safe to say that it is a more holistic assessment of the different estimation strategies. "]]
